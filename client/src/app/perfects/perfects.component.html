<div class="Block">
  <label id="lbl">CSV File : </label>&nbsp;
  <input type="file" (change)="fileChanged($event)" />
</div>
<div class="container">
  <div class="form-inline">
    <div class="btn-group">
      <button
        class="btn btn-primary"
        btnRadio="LoadEmployee"
        (click)="onClickEmp()"
      >
        <i class="fa fa-address-card"></i> Load Employee
      </button>
      <button
        class="btn btn-primary"
        btnRadio="LoadAccrual"
        (click)="onClickAcr()"
      >
        <i class="fa fa-envelope"></i> Load Accrual by Fund
      </button>
    </div>
    &nbsp;&nbsp;
    <div class="btn-group">
      <button
        class="btn btn-primary"
        btnRadio="Excel"
        (click)="getErrors() > 0 ? openModal(template) : exportExcel"
      >
        <i class="fa fa-file-excel-o"></i> Export to Excel
      </button>
    </div>
    &nbsp;&nbsp;&nbsp;
    <div class="btn-group">
      <button class="btn btn-primary" btnRadio="Clear" (click)="deleteData()">
        <i class="fa fa-trash"></i> Clear Data
      </button>
    </div>
    &nbsp;&nbsp;
    <div class="btn-group" data-toggle="buttons">
      <label class="btn btn-default center-block"
        ><input
          *ngIf="drecsAcr"
          [(ngModel)]="drecsAcr.myob"
          type="radio"
          name="myobtype"
          id="btnradio1"
          autocomplete="off"
          [value]="0"
          (change)="onItemChange(drecsAcr)"
        />&nbsp;Online</label
      >
      <label class="btn btn-default center-block"
        ><input
          *ngIf="drecsAcr"
          [(ngModel)]="drecsAcr.myob"
          type="radio"
          name="myobtype"
          id="btnradio1"
          autocomplete="off"
          [value]="1"
          (change)="onItemChange(drecsAcr)"
        />&nbsp;Standalone</label
      >
    </div>
    &nbsp;&nbsp;
  </div>
</div>
<strong *ngIf="accrual">Errors: {{ getErrors() }}</strong>
<div class="row mt-1">
  <p *ngIf="drecsEmp && drecsAcr">
    Employee data last updated at&nbsp;{{
      drecsEmp.updated | date: "dd/MM/yyyy HH:mm"
    }}&nbsp;{{ drecsEmp.desc }}&nbsp;&nbsp;&nbsp; Accrual By Fund Report last
    updated at&nbsp;{{ drecsAcr.updated | date: "dd/MM/yyyy HH:mm" }}&nbsp;{{
      drecsAcr.desc
    }}&nbsp;&nbsp;
  </p>
</div>
<tabset class="member-tabset">
  <tab heading="List">
    <div class="row">
      <font [size]="1">
        <table class="table table-condensed">
          <thead>
            <tr>
              <th>USI</th>
              <th>PayrollID</th>
              <th>MemberID</th>
              <th>Last Name</th>
              <th>First Name</th>
              <th>DOB</th>
              <th>Gender</th>
              <th>SuperGuarantee</th>
              <th>Spouse</th>
              <th>SalarySacrifice</th>
              <th>Redundancy</th>
              <th>Productivity</th>
              <th>EmployeeCategory</th>
              <th>EmployeeBasis</th>
              <th>CustomList2</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let item of accrual">
              <td>{{ item.usi }}</td>
              <td>{{ item.payrollID }}</td>
              <td>{{ item.memberID }}</td>
              <td>{{ item.lastName }}</td>
              <td>{{ item.firstName }}</td>
              <td>{{ item.dob }}</td>
              <td>{{ item.gender }}</td>
              <td>{{ item.superGuarantee | currency: "USD" }}</td>
              <td>{{ item.spouse | currency: "USD" }}</td>
              <td>{{ item.salarySacrifice | currency: "USD" }}</td>
              <td>{{ item.redundancy | currency: "USD" }}</td>
              <td>{{ item.productivity | currency: "USD" }}</td>
              <td
                [ngStyle]="{
                  'background-color': !(
                    (item.empCategory === 'Temporary' &&
                      item.empStatus === 'Casual' &&
                      item.customList2 === 'FTM') ||
                    (item.empCategory === 'Permanent' &&
                      item.empStatus === 'Full Time' &&
                      item.customList2 === 'Salaries') ||
                    (item.empCategory === 'Permanent' &&
                      item.empStatus === 'Part Time' &&
                      item.customList2 === 'Salaries')
                  )
                    ? 'red'
                    : 'white',
                  color: !(
                    (item.empCategory === 'Temporary' &&
                      item.empStatus === 'Casual' &&
                      item.customList2 === 'FTM') ||
                    (item.empCategory === 'Permanent' &&
                      item.empStatus === 'Full Time' &&
                      item.customList2 === 'Salaries') ||
                    (item.empCategory === 'Permanent' &&
                      item.empStatus === 'Part Time' &&
                      item.customList2 === 'Salaries')
                  )
                    ? 'white'
                    : 'black'
                }"
              >
                {{ item.empCategory }}
              </td>
              <td
                [ngStyle]="{
                  'background-color': !(
                    (item.empCategory === 'Temporary' &&
                      item.empStatus === 'Casual' &&
                      item.customList2 === 'FTM') ||
                    (item.empCategory === 'Permanent' &&
                      item.empStatus === 'Full Time' &&
                      item.customList2 === 'Salaries') ||
                    (item.empCategory === 'Permanent' &&
                      item.empStatus === 'Part Time' &&
                      item.customList2 === 'Salaries')
                  )
                    ? 'red'
                    : 'white',
                  color: !(
                    (item.empCategory === 'Temporary' &&
                      item.empStatus === 'Casual' &&
                      item.customList2 === 'FTM') ||
                    (item.empCategory === 'Permanent' &&
                      item.empStatus === 'Full Time' &&
                      item.customList2 === 'Salaries') ||
                    (item.empCategory === 'Permanent' &&
                      item.empStatus === 'Part Time' &&
                      item.customList2 === 'Salaries')
                  )
                    ? 'white'
                    : 'black'
                }"
              >
                {{ item.empStatus }}
              </td>
              <td
                [ngStyle]="{
                  'background-color': !(
                    (item.empCategory === 'Temporary' &&
                      item.empStatus === 'Casual' &&
                      item.customList2 === 'FTM') ||
                    (item.empCategory === 'Permanent' &&
                      item.empStatus === 'Full Time' &&
                      item.customList2 === 'Salaries') ||
                    (item.empCategory === 'Permanent' &&
                      item.empStatus === 'Part Time' &&
                      item.customList2 === 'Salaries')
                  )
                    ? 'red'
                    : 'white',
                  color: !(
                    (item.empCategory === 'Temporary' &&
                      item.empStatus === 'Casual' &&
                      item.customList2 === 'FTM') ||
                    (item.empCategory === 'Permanent' &&
                      item.empStatus === 'Full Time' &&
                      item.customList2 === 'Salaries') ||
                    (item.empCategory === 'Permanent' &&
                      item.empStatus === 'Part Time' &&
                      item.customList2 === 'Salaries')
                  )
                    ? 'white'
                    : 'black'
                }"
              >
                {{ item.customList2 }}
              </td>
            </tr>
          </tbody>
        </table>
      </font>
    </div>
  </tab>
  <tab heading="Upload File">
    <app-file-manager [accrual]="accrual"></app-file-manager>
  </tab>
</tabset>

<ng-template #template>
  <div class="modal-header">
    <h4 class="modal-title pull-left">Error</h4>
    <button
      type="button"
      class="close pull-right"
      aria-label="Close"
      (click)="closeModal()"
    >
      <span aria-hidden="true">Ã—</span>
    </button>
  </div>
  <div class="modal-body">Found {{ getErrors() }} missmatch errors!</div>
  <div class="modal-footer">
    <button type="button" class="btn btn-default" (click)="closeModal()">
      Close
    </button>
  </div>
</ng-template>
